<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="whatlastgenre : Improves genre metadata of audio files based on tags from various music sites.">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>whatlastgenre</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/YetAnotherNerd/whatlastgenre">View on GitHub</a>

          <h1 id="project_title">whatlastgenre</h1>
          <h2 id="project_tagline">Improves genre metadata of audio files based on tags from various music sites.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/YetAnotherNerd/whatlastgenre/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/YetAnotherNerd/whatlastgenre/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="whatlastgenre" class="anchor" href="#whatlastgenre"><span class="octicon octicon-link"></span></a>whatlastgenre</h1>

<p>Improves genre metadata of audio files based on tags from various music sites.</p>

<ul>
<li>Supported audio files: flac, ogg, mp3, m4a</li>
<li>Supported music sites: WhatCD, LastFM, MusicBrainz, Discogs, EchoNest, Idiomag </li>
<li>Feature Overview

<ul>
<li>Gets genre tags for artists and albums from music sites and finds the
most eligible ones by merging, splitting, filtering and scoring them.

<ul>
<li>Merges similar tags in different writings to ensure consistent names,
eg. DnB, D&amp;B, Drum and Bass -&gt; Drum &amp; Bass;
Alt., Altern, Alterneitif -&gt; Alternative</li>
<li>Splits tags in various applicable ways, eg.
Jazz/Funk&amp;Rock -&gt; Jazz, Funk, Rock;
Alternative Rock -&gt; Alternative, Rock</li>
<li>Filters by personal preferences and preset or custom filters</li>
<li>Scores tags while taking personal preferences into account</li>
</ul>
</li>
<li>Caches all data received from music sites to make reruns super fast</li>
<li>Makes use of MusicBrainz IDs when possible</li>
<li>Optional: gets release type (Album, EP, Anthology, ...) (from What)</li>
<li>Optional: gets MusicBrainz IDs</li>
<li>Interactive mode (it's not guessing wrong data)</li>
<li>Dry-mode for safe testing</li>
</ul>
</li>
</ul><h2>
<a name="how-it-works" class="anchor" href="#how-it-works"><span class="octicon octicon-link"></span></a>How it works</h2>

<p>It scans through folders for albums and receives genre tags for them and their
artists from different music sites. Equal tags in different writings will be
merged together to ensure proper scoring and consistent names. Tags containing
separators, too many words or specific parts will get split up. The tags get
filtered and scored. Artist and album tags get stored separately at first, but
get merged in the end and the best scored tags will be saved as genre metadata
in the corresponding album tracks. All data received from music sites will get
cached so that rerunning the script will be super fast. There are several
score multipliers to adjust the scoring to your needs and take your personal
preferences into account. Please take a look at "Configuration options
explained" below for more details.</p>

<h3>
<a name="basic-scoring" class="anchor" href="#basic-scoring"><span class="octicon octicon-link"></span></a>Basic Scoring</h3>

<h4>
<a name="tags-scoring-with-count-lastfm-musicbrainz-idiomag-what-partially" class="anchor" href="#tags-scoring-with-count-lastfm-musicbrainz-idiomag-what-partially"><span class="octicon octicon-link"></span></a>Tags scoring with count (Last.FM, MusicBrainz, Idiomag, What partially)</h4>

<p>If counts are supplied for the tags they will get scored by <code>count/topcount</code>,
where <code>topcount</code> is the highest count of all tags from a source. So the top
tag gets a score of 1.0, a tag having only half of the top tag's count gets
a score of 0.5 and so on. </p>

<h4>
<a name="tags-scoring-without-count-discogs-echonest-what-partially" class="anchor" href="#tags-scoring-without-count-discogs-echonest-what-partially"><span class="octicon octicon-link"></span></a>Tags scoring without count (Discogs, EchoNest, What partially)</h4>

<p>Tags supplied without a count will be scored <code>0.85^(n-1)</code>, where <code>n</code> is the
total number of tags supplied by this source. The more tags the lower the score
for each tag will be. So if only one tag is supplied, it will get a score of
1.0, two tags will get a score of 0.85 each, three get 0.72 each and so on...</p>

<h2>
<a name="installation" class="anchor" href="#installation"><span class="octicon octicon-link"></span></a>Installation</h2>

<p>You'll need Python 2.7. Running the following should also automatically install
all needed dependencies (mutagen, requests):</p>

<pre><code>$ python setup.py install
</code></pre>

<h2>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>A configuration file with default values will be created on first run.</p>

<h3>
<a name="example-configuration-file" class="anchor" href="#example-configuration-file"><span class="octicon octicon-link"></span></a>Example configuration file</h3>

<pre><code>[wlg]
sources = whatcd, mbrainz, lastfm, discogs
tagsfile = tags.txt
cache_timeout = 30
whatcduser = whatusername
whatcdpass = whatpassword
[genres]
love = soundtrack
hate = alternative, electronic, indie, pop, rock
blacklist = charts, male vocalist, other
filters = instrument, label, location, name, year
[scores]
src_whatcd = 1.66
src_lastfm = 0.66
src_mbrainz = 1.00
src_discogs = 1.00
src_idiomag = 1.00
src_echonest = 1.00
artist = 1.33
splitup = 0.33
</code></pre>

<h3>
<a name="configuration-options-explained" class="anchor" href="#configuration-options-explained"><span class="octicon octicon-link"></span></a>Configuration options explained</h3>

<h4>
<a name="whatlastgenre-wlg-section" class="anchor" href="#whatlastgenre-wlg-section"><span class="octicon octicon-link"></span></a>whatlastgenre (wlg) section</h4>

<h5>
<a name="sources-option" class="anchor" href="#sources-option"><span class="octicon octicon-link"></span></a>sources option</h5>

<p>The music sites/data providers where to get the tags from. Will be called in
the order you named them, since lastfm supports search by MBIDs make sure to
mention mbrainz before lastfm. You should generally mention sources with good
spelled tags (eg. sources with a fixed set of possible genres) before sources
with misspelled tags (eg. lastfm user tags) to avoid getting malformed tags.
Disabling music sites is not recommended, the more sources the better tags.</p>

<ul>
<li>
<code>whatcd</code> [<a href="https://what.cd/">URL</a>]
well-kept tags from users</li>
<li>
<code>lastfm</code> [<a href="http://www.last.fm/">URL</a>]
mbid search possible, many personal tags from users</li>
<li>
<code>mbrainz</code> [<a href="http://musicbrainz.org/">URL</a>]
home of mbids</li>
<li>
<code>discogs</code> [<a href="http://www.idiomag.com/">URL</a>]
album search only, fixed list of <a href="http://www.discogs.com/help/submission-guidelines-release-genres-styles.html">genres</a> and <a href="http://wiki.discogs.com/index.php/Style_Guide">styles</a>
</li>
<li>
<code>idiomag</code> [<a href="http://www.idiomag.com/">URL</a>]
artist search only </li>
<li>
<code>echonest</code> [<a href="http://echonest.com/">URL</a>]
artist search only, fixed list of <a href="http://developer.echonest.com/docs/v4/artist.html#list-genres">genres</a>
</li>
</ul><h5>
<a name="tagsfile-option" class="anchor" href="#tagsfile-option"><span class="octicon octicon-link"></span></a>tagsfile option</h5>

<p>Path to the tags.txt file. Use an absolute path here if you have problems
accessing the tagsfile by default.</p>

<h5>
<a name="cache_timout-option" class="anchor" href="#cache_timout-option"><span class="octicon octicon-link"></span></a>cache_timout option</h5>

<p>Time in days after which cache hits get invalid.
Default <code>7</code>, Range <code>3 - 90</code></p>

<h4>
<a name="genres-section" class="anchor" href="#genres-section"><span class="octicon octicon-link"></span></a>genres section</h4>

<h5>
<a name="love-and-hate-options" class="anchor" href="#love-and-hate-options"><span class="octicon octicon-link"></span></a>love and hate options</h5>

<p>List of tags that get a multiplier bonus of <code>2.0</code> and <code>0.5</code> respectively.
Should be considered as "soft white-/blacklist" where you can in-/decrease the
occurrence of specific tags that you don't like or that are too inaccurate for
you without fully banning them like with the blacklist option.</p>

<h5>
<a name="filters-option" class="anchor" href="#filters-option"><span class="octicon octicon-link"></span></a>filters option</h5>

<p>Use this to activate filters for specific tag groups:</p>

<ul>
<li>
<code>instrument</code> instrument related names, like piano or guitarist</li>
<li>
<code>label</code> label names</li>
<li>
<code>location</code> country, city and nationality names</li>
<li>
<code>year</code> year tags, like 1980s</li>
<li>create your own filter lists by adding filter sections to the tags.txt file,
consider them as large blacklists.</li>
</ul><h4>
<a name="scores-section" class="anchor" href="#scores-section"><span class="octicon octicon-link"></span></a>scores section</h4>

<h5>
<a name="src_-options" class="anchor" href="#src_-options"><span class="octicon octicon-link"></span></a>src_* options</h5>

<p>Every source has its own score multiplier, so music sites that generally
provide higher quality tags can be given advantage over sources that often
provide bad, inaccurate or personal tags. Increase if you trust the tags from
a source, lower if the source provides many inaccurate or personal tags. If you
don't want tags from a specific source remove it from the sources list option.
Default <code>1.0</code>, Range <code>0.5 - 2.0</code>. See sources option above.</p>

<h5>
<a name="artist-option" class="anchor" href="#artist-option"><span class="octicon octicon-link"></span></a>artist option</h5>

<p>Score multiplier to give tags found by artist/albumartist searches advantage
over tags from album searches. The tags get stored separately at first but
then put together while taking this multiplier into account. This enables
that multiple albums from one artist get more equal tags.
Default <code>1.33</code>, Range <code>0.5 - 2.0</code></p>

<ul>
<li>
<code>&lt; 1.0</code> prefer album tags</li>
<li>
<code>= 1.0</code> handle them equally</li>
<li>
<code>&gt; 1.0</code> prefer artist tags</li>
</ul><h5>
<a name="splitup-option" class="anchor" href="#splitup-option"><span class="octicon octicon-link"></span></a>splitup option</h5>

<p>Score multiplier for modifying the score of the base tag from a tag that got
split up by space, this enables you to decide whether to keep, prefer or ban
the base tags. For example, lets say we have 'Alternative Rock' with a score
of 1: It will end up as Alternative with score 1, Rock with score 1 and
Alternative Rock with score <code>1 * &lt;splitup-score&gt;</code>. So if you don't want to keep
Alternative Rock, just set it to 0, but consider using a very small number
instead to avoid banning them totally.
Default <code>0.33</code>, Range <code>0.0 - 1.0</code></p>

<ul>
<li>
<code>= 0.0</code> forget about the "base" tags</li>
<li>
<code>&lt; 1.0</code> prefer split parts</li>
<li>
<code>= 1.0</code> handle them equally</li>
</ul><h2>
<a name="usage" class="anchor" href="#usage"><span class="octicon octicon-link"></span></a>Usage</h2>

<pre><code>usage: whatlastgenre [-h] [-v] [-n] [-c] [-i] [-r] [-m] [-l N]
                     [--config CONFIG] [--cache CACHE]
                     path [path ...]

Improves genre metadata of audio files based on tags from various music sites.

positional arguments:
  path                 folder(s) to scan for albums

optional arguments:
  -h, --help           show this help message and exit
  -v, --verbose        more detailed output (default: False)
  -n, --dry            don't save metadata (default: False)
  -c, --cacheignore    ignore cache hits (default: False)
  -i, --interactive    interactive mode (default: False)
  -r, --tag-release    tag release type (from What) (default: False)
  -m, --tag-mbids      tag musicbrainz ids (default: False)
  -l N, --tag-limit N  max. number of genre tags (default: 4)
  --config CONFIG      location of the configuration file
                       (default: ~/.whatlastgenre/config)
  --cache CACHE        location of the cache file
                       (default: ~/.whatlastgenre/cache)
</code></pre>

<p>If you seriously want to tag release-types <code>-r</code> or musicbrainz-ids <code>-m</code> you
should also enable interactive mode <code>-i</code>. Consider to save the MBIDs <code>-m</code> when
using mbrainz, you searched for them, why not save them? ;)</p>

<p>I recommend first doing a dry-run to fill the cache and then doing a normal
run with interactivity enabled. This way you can answer all interactivity
questions without much waiting time in between.</p>

<p>Remove the cache file to reset the cache. If you only want to reset the cache
for specific albums rerun with <code>-c</code> on this albums to ignore cache hits.</p>

<h3>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h3>

<p>Do a verbose dry-run on your albums in /home/user/music changing nothing:</p>

<pre><code>$ whatlastgenre -vn /home/user/music
</code></pre>

<p>Tag max. 3 genre tags for all albums in /home/user/music:</p>

<pre><code>$ whatlastgenre -l 3 /home/user/music
</code></pre>

<p>To get the most of it for all albums in /home/user/music and /media/music:</p>

<pre><code>$ whatlastgenre -irml 5 /home/user/music /media/music
</code></pre>

<p>whatlastgenre doesn't correct any other tags. If your music files are badly or
not tagged, whatlastgenre won't work well at all.</p>

<p>Please report any bugs and errors you encounter, i would like to fix them :)</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">whatlastgenre maintained by <a href="https://github.com/YetAnotherNerd">YetAnotherNerd</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
